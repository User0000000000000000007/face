<html lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=0.9 , user-scalable=0;">
<link href="style.css" rel="stylesheet">

</head>
<body>
  
<div id="loading" class="htmlloading">Loading...</div>
<div id="aaaa" class="htmlloading">

  <div id="aaa" style="width: 120%;"></div></div>

<div id="maindiv" class="container">
  <h1>Todays To-DO</h1>
  <h4 id="h4">Todays To-DO</h4>

<div id="header">
  <h2>What to do now:</h2>
  <p id="current-task">Script Error</p>
</div>
<ul class="todo-list" id="todo-list" ></ul>
</div>
<svg style="position: fixed; top: 10px;right: 10px; cursor: pointer; width: 60px; height: 60px; border: 5px solid; border-radius: 1000px; z-index: 111111111111;" class="back-button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="red" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" onclick="window.location.replace('set.html');">
  <polyline points="9 18 15 12 9 6"></polyline>
</svg>

<script >
   var created = 1;
const weekday = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
const d = new Date();
let day = weekday[d.getDay()];
document.getElementById("h4").innerHTML = "Today is "+day;
function st(){  
  if(localStorage.taskscount > 0){
  let data = localStorage['taskdetail'+created];
    let sat = data.match(/sat=(\d+)/);
    let sun = data.match(/sun=(\d+)/);
    let mon = data.match(/mon=(\d+)/);
    let tue = data.match(/tue=(\d+)/);
    let wed = data.match(/wed=(\d+)/);
    let thu = data.match(/thu=(\d+)/);
    let fri = data.match(/fri=(\d+)/);
    let cat = data.match(/category=([^&]*)/);
    let taskname = data.match(/taskname=([^&]*)/);
    let done = data.match(/done=([^&]*)/);
if(taskname[1] == 0){} else{

  if(day == "Saturday"){if(sat[1]== "1"){}else{ created++;ts();return;}}
  if(day == "Sunday"){if(sun[1]== "1"){}else{created++;ts(); return;}}
  if(day == "Monday"){if(mon[1]== "1"){}else{created++;ts(); return;}}
  if(day == "Tuesday"){if(tue[1]== "1"){}else{created++;ts(); return;}}
  if(day == "Wednesday"){if(wed[1]== "1"){}else{created++;ts(); return;}}
  if(day == "Thursday"){if(thu[1]== "1"){}else{created++;ts(); return;}}
  if(day == "Friday"){if(fri[1]== "1"){}else{created++;ts(); return;}}

  const todoList = document.getElementById('todo-list');
  const taskDiv = document.createElement('label');
      taskDiv.className = 'todo-item';
      taskDiv.id = `l-${created}`;      
      taskDiv.setAttribute('for', `task-${created}`);      
      taskDiv.innerHTML = `
  <input type="checkbox" class="Task" id="task-${created}" oninput="if(this.checked) {localStorage.taskdetail${created} = localStorage.taskdetail${created}.replace(/done=[^&]*/, 'done=1');this.setAttribute('done','1');}else{localStorage.taskdetail${created} = localStorage.taskdetail${created}.replace(/done=[^&]*/, 'done=0');this.setAttribute('done','');}checkTasks();">
  <label for="task-${created}" id="task${created}"></label>
  <button class="skipbutton" id="skiper-${created}" onclick="var aaa = document.getElementById('task-${created}'); if(!aaa.disabled){aaa.disabled = true;aaa.setAttribute('done','1');document.getElementById('task-${created}').checked = false; this.innerHTML ='Undo skip';localStorage.taskdetail${created} = localStorage.taskdetail${created}.replace(/done=[^&]*/, 'done=3');}else{aaa.disabled = false;aaa.setAttribute('done','');this.innerHTML ='skip';localStorage.taskdetail${created} = localStorage.taskdetail${created}.replace(/done=[^&]*/, 'done=0');} ; checkTasks();" >skip</button>
  `;
 todoList.appendChild(taskDiv);
    document.getElementById(`task${created}`).innerText = decodeURIComponent(taskname[1]);
    if (done && done[1] === "1"){document.getElementById(`task-${created}`).checked = true;}
    else if (done && done[1] === "0") {document.getElementById(`task-${created}`).checked = false;}
    else if (done && done[1] === "3") {document.getElementById(`task-${created}`).disabled = true;document.getElementById(`task-${created}`).setAttribute('done','1');document.getElementById(`skiper-${created}`).innerHTML="Undo skip";}}    
    created++;
  ts(); 
  }
}
function ts() {
  if(created <= localStorage.taskscount){st();}
} st();


function checkTasks() {
        const tasks = document.querySelectorAll('.task'); // Get all tasks
        let allCompleted = true;
        for (let i = 0; i < tasks.length; i++) {
            if (!tasks[i].getAttribute("done") == "1") {
                const taskName = tasks[i].parentElement.textContent; // Get the label text
                document.getElementById('current-task').innerHTML = 'You should : ' + taskName;
                document.getElementById('current-task').innerHTML = document.getElementById('current-task').innerHTML.replace(/skip/,'');
                allCompleted = false; break;
        }
              }
if (allCompleted) {
  if(localStorage.taskscount > 0){
    if(document.querySelectorAll('.task').length > 0){
    document.getElementById('current-task').innerHTML = 'You have ended your day';
  }
  else{document.getElementById('current-task').innerHTML = `Hmm, Looks like you didn't mentioned any task name or maybe an unexpected error occured`;}
      
  
  }
  else{document.getElementById('current-task').innerHTML = 'Great Start!, Lets create some tasks and I will advice you';}

}
    }
    setInterval(checkTasks,1000);checkTasks();
</script>



</body></html>